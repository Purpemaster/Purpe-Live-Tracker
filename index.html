<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Donation Tracker</title>

  <!-- Google Fonts – Orbitron für futuristischen Hacker-Vibe -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">

  <!-- Dein Style, du Künstler -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- HIER ist dein kosmischer Hintergrund -->
  <div class="background"></div>

  <!-- Der Rest deines Inhalts -->
  <div class="container">
    <div class="title pulse">Live Donation Tracker</div>
    
    <div class="progress-bar">
      <div class="progress-fill" style="width: 23.51%;"></div> <!-- Beispielwert -->
    </div>

    <div class="amounts">
      <span>$4702.62</span>
      <span>$20,000</span>
    </div>

    <div class="info-box">
      <p>Purple Pepe is becoming a legend –<br> this wallet is the fuel.</p>
      <p>Your donation powers our journey to the world's biggest exchanges.</p>
      <p>SOL: $1383.12<br>
         PURPE: $2774.50<br>
         PYUSD: $545.00</p>
    </div>
  </div>

  <!-- Dein ursprüngliches Skript bleibt unberührt -->
  <script src="script.js"></script>

  <!-- Neues PYUSD-Tracking via Solana (autonom & brav) -->
  <script>
    const SOLANA_WALLET = "2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo";
    const PYUSD_MINT = "F64NDwsvzu2i3KSYDhrPaZVJQDXZeZ37cZWLN1LduBNY";
    const HELIUS_API_KEY = "2e046356-0f0c-4880-93cc-6d5467e81c73";

    async function fetchSolanaPYUSD() {
      const url = `https://api.helius.xyz/v0/addresses/${SOLANA_WALLET}/transactions?api-key=${HELIUS_API_KEY}`;

      try {
        const res = await fetch(url);
        const txs = await res.json();

        let totalPYUSD = 0;

        txs.forEach(tx => {
          if (!tx.tokenTransfers) return;

          tx.tokenTransfers.forEach(transfer => {
            if (
              transfer.tokenMint === PYUSD_MINT &&
              transfer.toUserAccount === SOLANA_WALLET
            ) {
              totalPYUSD += transfer.amount / Math.pow(10, transfer.decimals);
            }
          });
        });

        // Übergabe an bestehendes donations-Objekt
        if (typeof donations !== "undefined") {
          donations.PYUSD = totalPYUSD;
          if (typeof updateDisplay === "function") updateDisplay();
        }

      } catch (err) {
        console.error("Fehler bei Solana-PYUSD-Abruf:", err);
      }
    }

    // Starte direkt und dann alle 60 Sekunden
    fetchSolanaPYUSD();
    setInterval(fetchSolanaPYUSD, 60000);
  </script>

</body>
</html>
